
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IFWL F1 Leaderboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: url('ifwl_bg.webp') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #000;
    }
    .version {
      position: fixed;
      top: 10px;
      left: 10px;
      font-size: 0.8em;
      color: #ccc;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 20px;
      margin-bottom: 10px;
    }
    .header img {
      height: 48px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(0, 0, 0, 0.75);
      margin: 20px 0;
      border-radius: 8px;
      overflow: hidden;
      color: white;
    }
    th, td {
      padding: 10px;
      text-align: center;
      vertical-align: middle;
      border-bottom: 1px solid #333;
    }
    th {
      background: #333;
      text-transform: uppercase;
      font-weight: bold;
    }
    tr:hover {
      background: rgba(255, 255, 255, 0.05);
    }
    img.car {
      height: 48px;
      vertical-align: middle;
      margin-right: 8px;
    }
    img.logo {
      height: 40px;
      float: right;
      margin-left: 10px;
    }
    .driver-row {
      position: relative;
      background-size: auto 100%;
      background-position: right center;
      background-repeat: no-repeat;
    }

    /* Team Colors and Logos */
    .team-MERCEDES       { background-color: #00D2BE; }
    .team-MCLAREN        { background-color: #FF8700; }
    .team-FERRARI        { background-color: #DC0000; }
    .team-HAAS           { background-color: #B6BABD; }
    .team-WILLIAMS       { background-color: #005AFF; }
    .team-RED\ BULL\ RACING,
    .team-RACING\ BULLS { background-color: #1B1443; }
    .team-ASTON\ MARTIN { background-color: #004940; }
    .team-KICK\ SAUBER  { background-color: #000000; }
    .team-RESERVE        { background-color: #FFFFFF; color: black; }

    .team-cell {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
  </style>
</head>
<body>
  <div class="version">Version: Beta 0.0.30 (Logos via JS; Team Colors Fixed)</div>
  <div class="header">
    <img src="ifwl_logo.png" alt="IFWL Logo" />
    <h1>IFWL F1 Leaderboard</h1>
    <img src="ifwl_logo.png" alt="IFWL Logo" />
  </div>

  <h2>Driver Standings</h2>
  <table id="driver-table">
    <thead>
      <tr><th>DRIVER</th><th>TEAM</th><th>TOTAL POINTS</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Constructors Standings</h2>
  <table id="constructor-table">
    <thead>
      <tr><th>TEAM</th><th>TOTAL POINTS</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <h2>Unassigned Drivers</h2>
  <table id="unassigned-table">
    <thead><tr><th>DRIVER</th></tr></thead>
    <tbody></tbody>
  </table>

  <script>
    const sheetId = "1OxEy3fx4fW1P-aPlU-AHlPR8r23KJieLKxdtKy4koog";
    const teamCars = {
      "ALPINE": "ALPINE.webp", "ASTON MARTIN": "ASTON.webp", "FERRARI": "FERRARI.webp",
      "HAAS": "HAAS.webp", "MCLAREN": "MCLAREN.webp", "MERCEDES": "MERCEDES.webp",
      "RACING BULLS": "RACINGBULLS.webp", "RED BULL RACING": "RBR.webp", "KICK SAUBER": "SAUBER.webp",
      "RESERVE": "RESERVE.webp", "WILLIAMS": "WILLIAMS.webp"
    };
    const teamLogos = {
      "ALPINE": "ALPINELOGO.webp", "ASTON MARTIN": "ASTONLOGO.webp", "FERRARI": "FERARRILOGO.webp",
      "HAAS": "HAASLOGO.webp", "MCLAREN": "MCLARENLOGO.webp", "MERCEDES": "MERCEDESLOGO.webp",
      "RACING BULLS": "RBLOGO.webp", "RED BULL RACING": "RBRLOGO.webp", "KICK SAUBER": "KICKLOGO.webp",
      "RESERVE": "RESERVELOGO.webp", "WILLIAMS": "WILLIAMSLOGO.webp"
    };
    fetch(`https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`)
      .then(res => res.text())
      .then(text => JSON.parse(text.substr(47).slice(0, -2)))
      .then(json => {
        const rows = json.table.rows.map(r => r.c.map(c => c?.v ?? ""));
        const drivers = rows.filter(r => r[0] && r[1]);
        const constructorMap = {};
        const driverTable = document.querySelector("#driver-table tbody");
        const constructorTable = document.querySelector("#constructor-table tbody");
        const unassignedTable = document.querySelector("#unassigned-table tbody");

        drivers.forEach(([driver, team, , , , , , , , , , , , , , , , , , , , , , , , points]) => {
          if (!team) {
            const unRow = document.createElement("tr");
            unRow.innerHTML = `<td>${driver}</td>`;
            unassignedTable.appendChild(unRow);
            return;
          }
          const normTeam = team.toUpperCase().trim();
          const row = document.createElement("tr");
          row.className = `driver-row team-${normTeam.replace(/ /g, "\ ")}`;
          row.innerHTML = `
            <td>${driver}</td>
            <td class="team-cell">
              <img src="${teamCars[normTeam]}" class="car" alt="${team}" />
              ${team}
              <img src="${teamLogos[normTeam]}" class="logo" alt="${team}" />
            </td>
            <td>${points || 0}</td>`;
          driverTable.appendChild(row);
          constructorMap[normTeam] = (constructorMap[normTeam] || 0) + (parseInt(points) || 0);
        });

        Object.entries(constructorMap).forEach(([team, total]) => {
          const row = document.createElement("tr");
          row.className = `driver-row team-${team.replace(/ /g, "\ ")}`;
          row.innerHTML = `
            <td class="team-cell">
              <img src="${teamCars[team]}" class="car" alt="${team}" />
              ${team}
              <img src="${teamLogos[team]}" class="logo" alt="${team}" />
            </td>
            <td>${total}</td>`;
          constructorTable.appendChild(row);
        });
      });
  </script>
</body>
</html>
