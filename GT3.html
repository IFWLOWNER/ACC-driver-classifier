<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>IFWL.net — GTEAM3 Rules & Procedures (2026)</title>
  <meta name="description" content="IFWL GTEAM3 team endurance rules, procedures, stewarding codes and ticket process." />

  <style>
    :root{
      --bg:#f7f7f8;
      --card:#ffffff;
      --ink:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;
      --pill:#f3f4f6;
      --shadow: 0 10px 25px rgba(0,0,0,.06);
      --radius: 16px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--sans);
      background: var(--bg);
      color: var(--ink);
      line-height: 1.45;
    }
    a{color:inherit}
    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 28px 18px 60px;
    }
    header{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-bottom: 16px;
    }
    .topline{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .brand h1{
      margin:0;
      font-size: 26px;
      letter-spacing: .2px;
    }
    .brand .sub{
      color: var(--muted);
      font-size: 14px;
    }
    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      border:1px solid var(--line);
      background: var(--card);
      border-radius: 999px;
      padding: 9px 12px;
      font-size: 13px;
      cursor:pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,.04);
    }
    .btn:active{transform: translateY(1px)}
    .search{
      display:flex;
      align-items:center;
      gap:8px;
      border:1px solid var(--line);
      background: var(--card);
      border-radius: 999px;
      padding: 8px 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,.04);
      min-width: min(520px, 100%);
      position: relative;
    }
    .search input{
      width:100%;
      border:none;
      outline:none;
      font-size: 14px;
      background: transparent;
      color: var(--ink);
    }
    .clearBtn{
      border:1px solid var(--line);
      background: var(--pill);
      border-radius: 999px;
      padding: 4px 10px;
      font-size: 12px;
      cursor:pointer;
      line-height: 1;
      display:none;
      box-shadow: 0 2px 8px rgba(0,0,0,.04);
    }
    .clearBtn:active{transform: translateY(1px)}
    .card{
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
      margin-top: 14px;
    }
    .note{
      background: #fff;
      border-left: 4px solid var(--ink);
      padding: 12px 12px;
      border-radius: 10px;
      border: 1px solid var(--line);
    }
    .note p{margin:0; color: var(--ink)}
    .muted{color: var(--muted)}
    .toc{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    @media (max-width: 820px){
      .toc{grid-template-columns: 1fr}
      .search{min-width: 100%}
    }
    .toc a{
      display:block;
      padding: 10px 12px;
      border: 1px solid var(--line);
      border-radius: 12px;
      background: var(--pill);
      text-decoration:none;
      font-size: 14px;
    }
    details.section{
      border: 1px solid var(--line);
      border-radius: var(--radius);
      background: var(--card);
      box-shadow: var(--shadow);
      margin-top: 12px;
      overflow:hidden;
    }
    summary{
      list-style:none;
      cursor:pointer;
      padding: 14px 16px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      user-select:none;
      font-weight: 800;
    }
    summary::-webkit-details-marker{display:none}
    .sum-left{
      display:flex; flex-direction:column; gap:4px;
    }
    .sum-left .kicker{
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
      letter-spacing: .2px;
      text-transform: uppercase;
    }
    .chev{
      font-family: var(--mono);
      color: var(--muted);
      font-weight: 800;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: var(--pill);
      height: fit-content;
    }
    details[open] summary{
      border-bottom: 1px solid var(--line);
      background: #fafafa;
    }
    details .content{
      padding: 14px 16px 16px;
    }
    h2,h3,h4{margin: 14px 0 8px}
    h2{font-size: 18px}
    h3{font-size: 16px}
    h4{font-size: 14px}
    p{margin: 8px 0}
    ul{margin: 8px 0 8px 18px}
    li{margin: 4px 0}
    .rule-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .rule{
      border: 1px solid var(--line);
      background: #fff;
      border-radius: 14px;
      padding: 12px 12px;
    }
    .rule .tag{
      display:inline-block;
      font-family: var(--mono);
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 999px;
      background: var(--pill);
      border: 1px solid var(--line);
      margin-bottom: 8px;
    }
    table{
      width:100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
      overflow:hidden;
      border-radius: 14px;
      border: 1px solid var(--line);
    }
    th,td{
      padding: 10px 10px;
      border-bottom: 1px solid var(--line);
      vertical-align: top;
    }
    th{
      text-align:left;
      background: #fafafa;
      font-weight: 800;
    }
    tr:last-child td{border-bottom:none}
    .pill{
      display:inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid var(--line);
      background: var(--pill);
      font-family: var(--mono);
      font-size: 12px;
    }
    footer{
      margin-top: 18px;
      color: var(--muted);
      font-size: 13px;
    }
    .small{font-size:13px}
    .kbd{
      font-family: var(--mono);
      font-size: 12px;
      padding: 2px 6px;
      border: 1px solid var(--line);
      border-bottom-width: 2px;
      border-radius: 8px;
      background: #fff;
    }
    .hide{display:none !important}
    .anchor{scroll-margin-top: 20px;}
    .tight ul{margin-top:6px}
    .sep{height:1px;background:var(--line);margin:10px 0}
  </style>
</head>

<body>
  <div class="wrap">
    <header class="card">
      <div class="topline">
        <div class="brand">
          <h1>IFWL.NET — GTEAM3 Rules & Procedures</h1>
          <div class="sub">GTEAM3 (ACC) — Team Endurance Events • 2026</div>
        </div>

        <div class="controls">
          <button class="btn" id="expandAll">Expand all</button>
          <button class="btn" id="collapseAll">Collapse all</button>
        </div>
      </div>

      <div class="search" aria-label="Search rules">
        <span class="muted" style="font-family:var(--mono);font-size:12px;">CTRL</span>
        <span class="muted" style="font-family:var(--mono);font-size:12px;">/</span>
        <input id="searchInput" type="search" placeholder="Search (e.g., “red flag”, “RP8”, “ticket window”)…" />
        <button class="clearBtn" id="clearSearch" type="button" aria-label="Clear search">✕</button>
      </div>

      <div class="note" style="margin-top:12px;">
        <p class="small">
          This is a dedicated handbook for IFWL GTEAM3 only. Edit freely. Discord participation is required throughout all sessions.
        </p>
      </div>

      <div style="margin-top:14px;">
        <h2 style="margin:0 0 8px;">Table of Contents</h2>
        <div class="toc">
          <a href="#overview">Overview</a>
          <a href="#procedures">Race Control Procedures</a>
          <a href="#tickets">Stewards Ticket Process</a>
          <a href="#stewardcodes">Stewards Codes Explained</a>
        </div>
      </div>
    </header>

    <!-- OVERVIEW -->
    <details class="section anchor" id="overview" open>
      <summary>
        <div class="sum-left">
          <div class="kicker">GTEAM3</div>
          <div>Overview (what matters)</div>
        </div>
        <div class="chev">+</div>
      </summary>
      <div class="content">
        <div class="rule-grid">
          <div class="rule tight">
            <div class="tag">Core rules</div>
            <ul>
              <li>Discord participation is mandatory throughout the event.</li>
              <li>All teams must monitor <span class="pill">#gteam3-announcements</span> during sessions.</li>
              <li>Server password is posted in Discord.</li>
              <li>Team endurance format: multi-driver teams (team size set per season announcement).</li>
              <li>Weather and time progression vary per round.</li>
            </ul>
          </div>

          <div class="rule tight">
            <div class="tag">Start driver</div>
            <ul>
              <li>The designated starting driver must be confirmed in <span class="pill">#team-confirmations</span>.</li>
              <li>For red flag restarts, the restart-starting driver must join the server first (see procedures).</li>
            </ul>
          </div>
        </div>
      </div>
    </details>

    <!-- PROCEDURES -->
    <details class="section anchor" id="procedures">
      <summary>
        <div class="sum-left">
          <div class="kicker">Race control</div>
          <div>Red flags, server crashes, starts & restarts</div>
        </div>
        <div class="chev">+</div>
      </summary>
      <div class="content">
        <div class="rule-grid">

          <div class="rule">
            <div class="tag">Red flag triggers</div>
            <p>A red flag may be issued by IFWL Race Control for:</p>
            <ul>
              <li>Mass disconnects / server crash</li>
              <li>Critical server instability impacting fairness/safety</li>
              <li>Any issue where continuation of the session cannot be guaranteed</li>
            </ul>
          </div>

          <div class="rule">
            <div class="tag">Red flag: idiot-proof timeline (with ACM GridMaker)</div>

            <p><strong>Step 1 — RED FLAG called (0 minutes)</strong></p>
            <ul>
              <li>Admin posts <strong>RED FLAG</strong> in <span class="pill">#gteam3-announcements</span>.</li>
              <li>All drivers lift, return to pits safely, and await instructions.</li>
              <li>No overtaking. No leaving unless instructed.</li>
            </ul>

            <div class="sep"></div>

            <p><strong>Step 2 — Cooldown / server OFFLINE (0–30 minutes)</strong></p>
            <ul>
              <li>Server shuts down for up to <strong>30 minutes</strong>.</li>
              <li>Admin captures latest valid running order.</li>
              <li>Admin generates the restart grid using <strong>ACM GridMaker</strong>.</li>
              <li>All teams stay in Discord and watch announcements.</li>
              <li><strong>Do not join the server early.</strong></li>
            </ul>

            <div class="sep"></div>

            <p><strong>Step 3 — PRACTICE session opens (30–50 minutes)</strong></p>
            <ul>
              <li>Server returns in <strong>PRACTICE</strong> for <strong>15–20 minutes</strong>.</li>
              <li>Teams join calmly, apply setups, and complete driver swaps.</li>
              <li><strong>The restart-starting driver must join first</strong> (as confirmed in <span class="pill">#team-confirmations</span>).</li>
              <li>This session is for organisation only — no racing required.</li>
            </ul>

            <div class="sep"></div>

            <p><strong>Step 4 — RACE session loads (50 minutes+)</strong></p>
            <ul>
              <li>Admin switches to <strong>RACE</strong> with:</li>
              <li>Remaining race time applied (downtime removed where applicable)</li>
              <li>ACM grid order applied</li>
              <li>Weather + time progression restored as closely as possible</li>
            </ul>

            <div class="sep"></div>

            <p><strong>Step 5 — Restart (formation + green flag)</strong></p>
            <ul>
              <li>Short formation lap</li>
              <li>Single file, hold position</li>
              <li>No overtaking until Race Control calls <strong>GREEN</strong></li>
            </ul>
          </div>

          <div class="rule">
            <div class="tag">Standard race start</div>
            <ul>
              <li>1 full formation lap</li>
              <li>Aided rolling start</li>
              <li>All cars remain in their green box until green flag</li>
              <li>No overtaking before green flag</li>
            </ul>
          </div>

          <div class="rule">
            <div class="tag">Restart start (after red flag)</div>
            <ul>
              <li>Short formation lap</li>
              <li>All cars remain in their green box until Race Control calls green</li>
              <li>No overtaking before green flag</li>
            </ul>
          </div>

          <div class="rule">
            <div class="tag">Lap 1 incident rule (start + restart)</div>
            <ul>
              <li>Any team found predominantly at fault for causing a collision on Lap 1 will receive a <strong>Drive Through</strong>.</li>
              <li>Once posted in <span class="pill">#live-incident-outcomes</span>, the team has <strong>5 laps</strong> to serve it.</li>
              <li>For each lap late, an additional <strong>10s Stop &amp; Go</strong> will be applied.</li>
              <li>IFWL may disqualify teams/drivers for behaviour below expected standards (including intentional collisions and poor Discord conduct).</li>
            </ul>
          </div>

        </div>
      </div>
    </details>

    <!-- TICKET PROCESS -->
    <details class="section anchor" id="tickets">
      <summary>
        <div class="sum-left">
          <div class="kicker">Stewarding</div>
          <div>Tickets, reporting, and appeals (timeframes)</div>
        </div>
        <div class="chev">+</div>
      </summary>
      <div class="content">
        <div class="rule-grid">

          <div class="rule">
            <div class="tag">Incident reporting</div>
            <ul>
              <li>All incidents must be reported in <span class="pill">#incident-reporting</span>.</li>
              <li>Incident reporting opens immediately after the race concludes.</li>
              <li>Incident reporting closes <strong>24 hours</strong> after the race ends.</li>
              <li>Late reports will not be reviewed.</li>
            </ul>
          </div>

          <div class="rule">
            <div class="tag">What to include in a ticket</div>
            <ul>
              <li>Lap number</li>
              <li>Timestamp (or session time)</li>
              <li>Cars/drivers involved</li>
              <li>Short summary of what happened</li>
              <li>Evidence: replay clip / stream VOD / screenshots (recommended)</li>
            </ul>
          </div>

          <div class="rule">
            <div class="tag">Appeals</div>
            <ul>
              <li>Appeals open immediately after the incident ticket window closes.</li>
              <li>Appeals remain open for <strong>24 hours</strong>.</li>
              <li>IFWL will post final decisions within <strong>24 hours</strong> after appeals close (where possible).</li>
              <li>Expected total timeline from race finish to final decisions: <strong>up to 72 hours</strong>.</li>
            </ul>
          </div>

        </div>
      </div>
    </details>

    <!-- STEWARD CODES -->
    <details class="section anchor" id="stewardcodes">
      <summary>
        <div class="sum-left">
          <div class="kicker">Appendix</div>
          <div>Stewards Codes Explained (use these in tickets)</div>
        </div>
        <div class="chev">+</div>
      </summary>
      <div class="content">
        <p class="muted">
          Use the search bar to find codes instantly (example: “RP8” or “blue flag”).
        </p>

        <table>
          <thead>
            <tr>
              <th>Code</th>
              <th>Group</th>
              <th>Title</th>
              <th>Description</th>
              <th>Who</th>
              <th>Penalty</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>RP1MI</td><td>RP1</td><td>Unsafe Track Rejoin</td><td>Driver rejoins track dangerously and causes issue</td><td>Rejoining driver</td><td>0s</td></tr>
            <tr><td>RP1ST</td><td>RP1</td><td>Unsafe Track Rejoin</td><td>Driver rejoins track dangerously and causes issue</td><td>Rejoining driver</td><td>20s</td></tr>
            <tr><td>RP1SE</td><td>RP1</td><td>Unsafe Track Rejoin</td><td>Driver rejoins track dangerously and causes issue</td><td>Rejoining driver</td><td>45s</td></tr>

            <tr><td>RP2MI</td><td>RP2</td><td>Unsafe Pit Exit — Crossing Pit Line</td><td>Driver exits pit unsafely and causes collision</td><td>Exiting driver</td><td>5s</td></tr>
            <tr><td>RP2ST</td><td>RP2</td><td>Unsafe Pit Exit — Crossing Pit Line</td><td>Driver exits pit unsafely and causes collision</td><td>Exiting driver</td><td>20s</td></tr>
            <tr><td>RP2SE</td><td>RP2</td><td>Unsafe Pit Exit — Crossing Pit Line</td><td>Driver exits pit unsafely and causes collision</td><td>Exiting driver</td><td>45s</td></tr>

            <tr><td>RP3MI</td><td>RP3</td><td>Blue Flag Abuse / Blocking While Lapped</td><td>Lapped driver impedes or blocks faster cars</td><td>Lapped driver</td><td>5s</td></tr>
            <tr><td>RP3ST</td><td>RP3</td><td>Blue Flag Abuse / Blocking While Lapped</td><td>Lapped driver impedes or blocks faster cars</td><td>Lapped driver</td><td>20s</td></tr>
            <tr><td>RP3SE</td><td>RP3</td><td>Blue Flag Abuse / Blocking While Lapped</td><td>Lapped driver impedes or blocks faster cars</td><td>Lapped driver</td><td>45s</td></tr>

            <tr><td>RP4MI</td><td>RP4</td><td>Formation Lap / Start Line Infringement</td><td>Occurs before race start on formation lap before lights</td><td>Driver out of position</td><td>Post-race ticket</td></tr>
            <tr><td>RP4ST</td><td>RP4</td><td>Formation Lap / Start Line Infringement</td><td>Occurs before race start on formation lap before lights</td><td>Driver out of position</td><td>Post-race ticket</td></tr>
            <tr><td>RP4SE</td><td>RP4</td><td>Formation Lap / Start Line Infringement</td><td>Occurs before race start on formation lap before lights</td><td>Driver out of position</td><td>30s</td></tr>

            <tr><td>RP5MI</td><td>RP5</td><td>Illegal Overtake (Off-track or Gained Advantage)</td><td>Driver gains position off-track or without completing legal pass</td><td>Overtaking driver</td><td>5s</td></tr>
            <tr><td>RP5ST</td><td>RP5</td><td>Illegal Overtake (Off-track or Gained Advantage)</td><td>Driver gains position off-track or without completing legal pass</td><td>Overtaking driver</td><td>20s</td></tr>
            <tr><td>RP5SE</td><td>RP5</td><td>Illegal Overtake (Off-track or Gained Advantage)</td><td>Driver gains position off-track or without completing legal pass</td><td>Overtaking driver</td><td>45s</td></tr>

            <tr><td>RP6MI</td><td>RP6</td><td>Late Blocking / Moving Under Braking</td><td>Driver defends with a late move under braking</td><td>Defending driver</td><td>5s</td></tr>
            <tr><td>RP6ST</td><td>RP6</td><td>Late Blocking / Moving Under Braking</td><td>Driver defends with a late move under braking</td><td>Defending driver</td><td>20s</td></tr>
            <tr><td>RP6SE</td><td>RP6</td><td>Late Blocking / Moving Under Braking</td><td>Driver defends with a late move under braking</td><td>Defending driver</td><td>45s</td></tr>

            <tr><td>RP7MI</td><td>RP7</td><td>Divebomb / Overly Ambitious Lunge</td><td>Overtake attempt from too far back causes contact</td><td>Overtaking driver</td><td>5s</td></tr>
            <tr><td>RP7ST</td><td>RP7</td><td>Divebomb / Overly Ambitious Lunge</td><td>Overtake attempt from too far back causes contact</td><td>Overtaking driver</td><td>15s</td></tr>
            <tr><td>RP7SE</td><td>RP7</td><td>Divebomb / Overly Ambitious Lunge</td><td>Overtake attempt from too far back causes contact</td><td>Overtaking driver</td><td>45s</td></tr>

            <tr><td>RP8MI</td><td>RP8</td><td>Rear-end Collision (Braking Zone)</td><td>Driver hits the car in front under braking</td><td>Driver behind</td><td>5s</td></tr>
            <tr><td>RP8ST</td><td>RP8</td><td>Rear-end Collision (Braking Zone)</td><td>Driver hits the car in front under braking</td><td>Driver behind</td><td>20s</td></tr>
            <tr><td>RP8SE</td><td>RP8</td><td>Rear-end Collision (Braking Zone)</td><td>Driver hits the car in front under braking</td><td>Driver behind</td><td>45s</td></tr>

            <tr><td>RP9MI</td><td>RP9</td><td>Squeezing Off Track / Not Leaving Room</td><td>Driver forces another car off track or fails to leave space</td><td>Defending driver</td><td>5s</td></tr>
            <tr><td>RP9ST</td><td>RP9</td><td>Squeezing Off Track / Not Leaving Room</td><td>Driver forces another car off track or fails to leave space</td><td>Defending driver</td><td>20s</td></tr>
            <tr><td>RP9SE</td><td>RP9</td><td>Squeezing Off Track / Not Leaving Room</td><td>Driver forces another car off track or fails to leave space</td><td>Defending driver</td><td>45s</td></tr>

            <tr><td>RP10MI</td><td>RP10</td><td>Excessive Flashing</td><td>Driver tries to impair vision by flashing lights</td><td>Overtaking driver</td><td>15s</td></tr>
            <tr><td>RP10ST</td><td>RP10</td><td>Excessive Flashing</td><td>Driver tries to impair vision by flashing lights</td><td>Overtaking driver</td><td>15s</td></tr>
            <tr><td>RP10SE</td><td>RP10</td><td>Excessive Flashing</td><td>Driver tries to impair vision by flashing lights</td><td>Overtaking driver</td><td>15s</td></tr>

            <tr><td>RP11MI</td><td>RP11</td><td>Intentional Ramming</td><td>No longer used</td><td>—</td><td>0s</td></tr>
            <tr><td>RP11ST</td><td>RP11</td><td>Intentional Ramming</td><td>Driver clearly and deliberately used their car to cause a major collision</td><td>—</td><td><strong>DQ</strong></td></tr>
            <tr><td>RP11SE</td><td>RP11</td><td>Intentional Ramming</td><td>No longer used</td><td>—</td><td><strong>DQ</strong></td></tr>

            <tr>
              <td>RP12MI</td><td>—</td><td>Driver Connection Issue</td>
              <td>Temporary instability/warping with minimal impact; racing continued safely</td>
              <td>—</td><td>10s</td>
            </tr>
            <tr>
              <td>RP12ST</td><td>—</td><td>Driver Connection Issue</td>
              <td>Unstable connection interfered with another car’s race; unsafe; driver did not attempt to resolve/ignored requests to pit/retire</td>
              <td>—</td><td>20s</td>
            </tr>
            <tr>
              <td>RP12SE</td><td>—</td><td>Driver Connection Issue</td>
              <td>Repeatedly caused major incidents/collision risk/contact due to warping; unsafe for field</td>
              <td>—</td><td>30s</td>
            </tr>

            <tr>
              <td>RP13MI</td><td>—</td><td>Wreckless Driving</td>
              <td>Unsafe driving/poor control created minor unnecessary risk; minimal impact; no time loss/damage to others</td>
              <td>—</td><td>10s</td>
            </tr>
            <tr>
              <td>RP13ST</td><td>—</td><td>Wreckless Driving</td>
              <td>Unsafe/unpredictable/aggressive actions impacting another driver’s race; avoidance/time loss/minor damage</td>
              <td>—</td><td>30s</td>
            </tr>
            <tr>
              <td>RP13SE</td><td>—</td><td>Wreckless Driving</td>
              <td>Any driver that has multiple penalties applied from incidents in a race</td>
              <td>—</td><td><strong>DQ</strong></td>
            </tr>
          </tbody>
        </table>
      </div>
    </details>

    <footer class="card">
      <div class="small muted">
        <strong>Keyboard tip:</strong> press <span class="kbd">Ctrl</span> + <span class="kbd">/</span> to jump to search.
      </div>
      <div class="small muted" style="margin-top:6px;">
        © IFWL.net — GTEAM3 Rules & Procedures.
      </div>
    </footer>
  </div>

  <script>
    // Expand/collapse chevrons and controls
    function syncChevrons(){
      document.querySelectorAll("details.section > summary .chev").forEach(ch => {
        const det = ch.closest("details");
        ch.textContent = det && det.open ? "–" : "+";
      });
    }

    function setAll(open){
      document.querySelectorAll("details.section").forEach(d => d.open = open);
      syncChevrons();
    }

    document.getElementById("expandAll").addEventListener("click", () => setAll(true));
    document.getElementById("collapseAll").addEventListener("click", () => setAll(false));

    document.querySelectorAll("details.section").forEach(d => {
      d.addEventListener("toggle", syncChevrons);
    });
    syncChevrons();

    // SEARCH (textContent so collapsed details are searchable)
    const input = document.getElementById("searchInput");
    const clearBtn = document.getElementById("clearSearch");
    const topSections = Array.from(document.querySelectorAll("details.section.anchor"));

    function normalize(s){ return (s || "").toLowerCase().replace(/\s+/g," ").trim(); }

    function applySearch(){
      const q = normalize(input.value);
      clearBtn.style.display = q ? "inline-flex" : "none";

      if(!q){
        topSections.forEach(s => s.classList.remove("hide"));
        return;
      }

      topSections.forEach(s => {
        const text = normalize(s.textContent);
        const match = text.includes(q);
        s.classList.toggle("hide", !match);
        if(match) s.open = true;
      });

      syncChevrons();
    }

    input.addEventListener("input", applySearch);
    clearBtn.addEventListener("click", () => {
      input.value = "";
      applySearch();
      input.focus();
    });

    document.addEventListener("keydown", (e) => {
      if(e.ctrlKey && e.key === "/"){
        e.preventDefault();
        input.focus();
      }
    });
  </script>
</body>
</html>
